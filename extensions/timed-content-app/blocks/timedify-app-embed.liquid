{% comment %}
  Timedify App Embed Block: loads in <head> to reduce FOUC
{% endcomment %}

<style>
  /* Reserve layout; JS decides final visibility */
  [data-timedify-range] { visibility: hidden !important; }
  .shopify-section[data-timedify-hidden="true"],
  .shopify-block[data-timedify-hidden="true"] { visibility: hidden !important; }
  .shopify-section[data-timedify-hidden="false"],
  .shopify-block[data-timedify-hidden="false"],
  [data-timedify-range][data-timedify-hidden="false"] { visibility: visible !important; }

  /* Scoped pre-hide within a section: content after Start is hidden until End */
  .shopify-section .timed-sections-start ~ * { visibility: hidden !important; }
  .shopify-section .timed-sections-end ~ * { visibility: visible !important; }

  /* Stronger pre-hide using :has() (supported in evergreen browsers) */
  /* Single-section: hide siblings after start within the same section */
  .shopify-section:has(.timed-sections-start) .timed-sections-start ~ * { visibility: hidden !important; }
  .shopify-section:has(.timed-sections-end) .timed-sections-end ~ * { visibility: visible !important; }

  /* Cross-section: hide sections following a section that contains a start marker */
  .shopify-section:has(.timed-sections-start) ~ .shopify-section { visibility: hidden !important; }
  /* Re-show sections following a section that contains an end marker */
  .shopify-section:has(.timed-sections-end) ~ .shopify-section { visibility: visible !important; }
</style>

{% if section.settings.debug %}
<script>window.__timedifyDebug = true;</script>
{% endif %}

<script src="{{ 'timedify-controller.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Timedify App Embed (Head)",
  "target": "head",
  "settings": [
    {
      "type": "checkbox",
      "id": "debug",
      "label": "Enable debug logging",
      "default": false
    }
  ]
}
{% endschema %}


